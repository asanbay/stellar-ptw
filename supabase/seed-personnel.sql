-- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
-- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç SQL –≤ Supabase SQL Editor

-- –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤ (–µ—Å–ª–∏ –∏—Ö –µ—â–µ –Ω–µ—Ç)
INSERT INTO departments (name, description, color, emoji) VALUES
('–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–¥–µ–ª', '–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', 'oklch(0.55 0.22 120)', '‚öôÔ∏è'),
('–û—Ç–¥–µ–ª —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è', '–¢–û –∏ —Ä–µ–º–æ–Ω—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è', 'oklch(0.55 0.22 200)', 'üîß'),
('–°–ª—É–∂–±–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏', '–û—Ö—Ä–∞–Ω–∞ —Ç—Ä—É–¥–∞ –∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', 'oklch(0.55 0.22 25)', 'üõ°Ô∏è'),
('–≠–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç–¥–µ–ª', '–≠–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ –∏ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', 'oklch(0.55 0.22 60)', '‚ö°')
ON CONFLICT DO NOTHING;

-- –ü–æ–ª—É—á–∏–º ID –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
DO $$
DECLARE
  dept_production UUID;
  dept_maintenance UUID;
  dept_safety UUID;
  dept_electrical UUID;
BEGIN
  SELECT id INTO dept_production FROM departments WHERE name = '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–¥–µ–ª' LIMIT 1;
  SELECT id INTO dept_maintenance FROM departments WHERE name = '–û—Ç–¥–µ–ª —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è' LIMIT 1;
  SELECT id INTO dept_safety FROM departments WHERE name = '–°–ª—É–∂–±–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏' LIMIT 1;
  SELECT id INTO dept_electrical FROM departments WHERE name = '–≠–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç–¥–µ–ª' LIMIT 1;

  -- –í—Å—Ç–∞–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
  INSERT INTO personnel (name, position, department_id, phone, email, role) VALUES
  
  -- –í—ã–¥–∞—é—â–∏–µ –Ω–∞—Ä—è–¥-–¥–æ–ø—É—Å–∫ (issuers)
  ('–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', '–ì–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä', dept_safety, '+7-777-111-0001', 'ivanov@stellar.kz', 'issuer'),
  ('–ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –°–µ—Ä–≥–µ–µ–≤–Ω–∞', '–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ –¢–ë', dept_safety, '+7-777-111-0002', 'petrova@stellar.kz', 'issuer'),
  ('–°–∏–¥–æ—Ä–æ–≤ –ü–µ—Ç—Ä –ê–ª–µ–∫—Å–µ–µ–≤–∏—á', '–ù–∞—á–∞–ª—å–Ω–∏–∫ —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–¥–µ–ª–∞', dept_electrical, '+7-777-111-0003', 'sidorov@stellar.kz', 'issuer'),
  
  -- –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç (supervisors)
  ('–ö–∞–∑—ã–º–æ–≤ –ê–ª–º–∞–∑ –ú–∞—Ä–∞—Ç–æ–≤–∏—á', '–°—Ç–∞—Ä—à–∏–π –º–∞—Å—Ç–µ—Ä', dept_production, '+7-777-222-0001', 'kazymov@stellar.kz', 'supervisor'),
  ('–ù—É—Ä–ª–∞–Ω–æ–≤–∞ –ê–π–≥—É–ª—å –¢–µ–º–∏—Ä—Ö–∞–Ω–æ–≤–Ω–∞', '–ú–∞—Å—Ç–µ—Ä —É—á–∞—Å—Ç–∫–∞', dept_production, '+7-777-222-0002', 'nurlanova@stellar.kz', 'supervisor'),
  ('–ê—Ö–º–µ—Ç–æ–≤ –ï—Ä–±–æ–ª –ö—É–∞–Ω–¥—ã–∫–æ–≤–∏—á', '–ù–∞—á–∞–ª—å–Ω–∏–∫ —Å–º–µ–Ω—ã', dept_maintenance, '+7-777-222-0003', 'akhmetov@stellar.kz', 'supervisor'),
  
  -- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç (foremen)
  ('–°–º–∏—Ä–Ω–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –í–∏–∫—Ç–æ—Ä–æ–≤–∏—á', '–ë—Ä–∏–≥–∞–¥–∏—Ä —ç–ª–µ–∫—Ç—Ä–∏–∫–æ–≤', dept_electrical, '+7-777-333-0001', 'smirnov@stellar.kz', 'foreman'),
  ('–¢–æ–∫—Ç–∞—Ä–æ–≤–∞ –ì—É–ª—å–Ω–∞—Ä–∞ –ê—Ö–º–µ—Ç–æ–≤–Ω–∞', '–ë—Ä–∏–≥–∞–¥–∏—Ä —Å–ª–µ—Å–∞—Ä–µ–π', dept_maintenance, '+7-777-333-0002', 'toktarova@stellar.kz', 'foreman'),
  ('–î–∂—É–º–∞–±–∞–µ–≤ –ï—Ä–ª–∞–Ω –ë–∞—É—ã—Ä–∂–∞–Ω–æ–≤–∏—á', '–ë—Ä–∏–≥–∞–¥–∏—Ä –º–æ–Ω—Ç–∞–∂–Ω–∏–∫–æ–≤', dept_production, '+7-777-333-0003', 'dzhumabaev@stellar.kz', 'foreman'),
  ('–õ–∏ –°–µ—Ä–≥–µ–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á', '–ë—Ä–∏–≥–∞–¥–∏—Ä —Å–≤–∞—Ä—â–∏–∫–æ–≤', dept_production, '+7-777-333-0004', 'li@stellar.kz', 'foreman'),
  
  -- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ (workers)
  ('–ê–±–¥—É–ª–ª–∞–µ–≤ –†—É—Å—Ç–∞–º –ò—Å–ª–∞–º–æ–≤–∏—á', '–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä 5 —Ä–∞–∑—Ä—è–¥–∞', dept_electrical, '+7-777-444-0001', NULL, 'worker'),
  ('–û–º–∞—Ä–æ–≤ –ë–µ–∫–∂–∞–Ω –°–µ—Ä–∏–∫–∫–∞–ª–∏–µ–≤–∏—á', '–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä 4 —Ä–∞–∑—Ä—è–¥–∞', dept_electrical, '+7-777-444-0002', NULL, 'worker'),
  ('–ú—É—Ö–∞–º–µ–¥–∂–∞–Ω–æ–≤–∞ –ê–π–Ω—É—Ä –ö–∞–π—Ä–∞—Ç–æ–≤–Ω–∞', '–°–ª–µ—Å–∞—Ä—å 5 —Ä–∞–∑—Ä—è–¥–∞', dept_maintenance, '+7-777-444-0003', NULL, 'worker'),
  ('–ñ–∞–Ω—É–∑–∞–∫–æ–≤ –î–∞—É—Ä–µ–Ω –ê—Å–ª–∞–Ω–æ–≤–∏—á', '–°–ª–µ—Å–∞—Ä—å 4 —Ä–∞–∑—Ä—è–¥–∞', dept_maintenance, '+7-777-444-0004', NULL, 'worker'),
  ('–ö–∏–º –ê–Ω–¥—Ä–µ–π –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á', '–ú–æ–Ω—Ç–∞–∂–Ω–∏–∫ 5 —Ä–∞–∑—Ä—è–¥–∞', dept_production, '+7-777-444-0005', NULL, 'worker'),
  ('–°–µ–π–¥–∞–ª–∏–µ–≤ –ú–∞—Ä–∞—Ç –ë–∞—Ö—ã—Ç–æ–≤–∏—á', '–ú–æ–Ω—Ç–∞–∂–Ω–∏–∫ 4 —Ä–∞–∑—Ä—è–¥–∞', dept_production, '+7-777-444-0006', NULL, 'worker'),
  ('–í–æ–ª–∫–æ–≤ –î–º–∏—Ç—Ä–∏–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á', '–°–≤–∞—Ä—â–∏–∫ 6 —Ä–∞–∑—Ä—è–¥–∞', dept_production, '+7-777-444-0007', NULL, 'worker'),
  ('–ë–∞–π—Ç—É—Ä—Å—ã–Ω–æ–≤ –ù—É—Ä–ª–∞–Ω –ñ–∞–∫—Å—ã–ª—ã–∫–æ–≤–∏—á', '–°–≤–∞—Ä—â–∏–∫ 5 —Ä–∞–∑—Ä—è–¥–∞', dept_production, '+7-777-444-0008', NULL, 'worker'),
  ('–†–∞—Ö–∏–º–æ–≤ –ñ–∞–Ω–¥–æ—Å –ú–∞—Ä–∞—Ç–æ–≤–∏—á', '–≠–ª–µ–∫—Ç—Ä–æ–≥–∞–∑–æ—Å–≤–∞—Ä—â–∏–∫ 5 —Ä–∞–∑—Ä—è–¥–∞', dept_production, '+7-777-444-0009', NULL, 'worker'),
  ('–¢—É–ª–µ–≥–µ–Ω–æ–≤–∞ –ñ–∞–Ω–Ω–∞ –ï—Ä–ª–∞–Ω–æ–≤–Ω–∞', '–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –û–¢–ö', dept_safety, '+7-777-444-0010', NULL, 'worker');

END $$;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
SELECT 
  p.id, 
  p.name, 
  p.position, 
  p.role,
  d.name as department_name,
  p.phone,
  p.email
FROM personnel p
LEFT JOIN departments d ON p.department_id = d.id
ORDER BY 
  CASE p.role 
    WHEN 'issuer' THEN 1
    WHEN 'supervisor' THEN 2
    WHEN 'foreman' THEN 3
    WHEN 'worker' THEN 4
  END,
  p.name;
