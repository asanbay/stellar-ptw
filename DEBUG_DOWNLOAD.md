# üîß –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º CSV

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–®–∞–±–ª–æ–Ω —Å–∫–∞—á–∞–Ω", –Ω–æ —Ñ–∞–π–ª —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è.

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ setTimeout
```typescript
setTimeout(() => {
  link.click()
  setTimeout(() => {
    // cleanup
  }, 100)
}, 0)
```
**–ü–æ—á–µ–º—É:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–¥ click() –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### 2. –î–æ–±–∞–≤–ª–µ–Ω `link.style.display = 'none'`
**–ü–æ—á–µ–º—É:** –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —á—Ç–æ–±—ã –æ–Ω –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ try-catch
```typescript
try {
  link.click()
  console.log('‚úÖ Template downloaded')
} catch (error) {
  console.error('‚ùå Download error:', error)
  toast.error('–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è')
}
```
**–ü–æ—á–µ–º—É:** –¢–µ–ø–µ—Ä—å –≤–∏–¥–∏–º —Ä–µ–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

### 4. –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```typescript
console.log('‚úÖ Template downloaded:', {
  fileName: 'personnel_template.csv',
  size: blob.size,
  delimiter,
  locale: navigator.language
})
```
**–ü–æ—á–µ–º—É:** –ú–æ–∂–µ–º –æ—Ç—Å–ª–µ–¥–∏—Ç—å —á—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Ç–∫—Ä—ã—Ç—å test-download.html
```bash
cd /workspaces/spark-template
# –û—Ç–∫—Ä–æ–π—Ç–µ test-download.html –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- ‚úÖ –î–≤–∞ –º–µ—Ç–æ–¥–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–æ—Å–Ω–æ–≤–Ω–æ–π + –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π)
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—É—é –æ—Ç–ª–∞–¥–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
3. –í–∫–ª–∞–¥–∫–∞ **Console**
4. –ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω"
5. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏:
   - ‚úÖ `Template downloaded:` - —É—Å–ø–µ—Ö
   - ‚ùå `Download error:` - –æ—à–∏–±–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∫–ª–∞–¥–∫—É Network
1. DevTools ‚Üí **Network**
2. –ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω"
3. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å `blob:http://...`
4. Type: `text/csv`
5. Size: ~600-800 –±–∞–π—Ç

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∫–æ–Ω–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–ª—è —Å–∞–π—Ç–∞

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –û—Ç–∫–ª—é—á–∏—Ç—å –≤—Å–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (Ctrl+Shift+P ‚Üí "–û—Ç–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è")
**–†–µ—à–µ–Ω–∏–µ:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ

### 3. MIME type –ø—Ä–æ–±–ª–µ–º–∞
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í –∫–æ–Ω—Å–æ–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å warnings –æ MIME
**–†–µ—à–µ–Ω–∏–µ:** –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º `text/csv;charset=utf-8;`

### 4. Popup blocker
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ ‚Üí –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Å–∞–π—Ç –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

### 5. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ –¥–ª—è Blob
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** DevTools ‚Üí Memory
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–∫—Ä—ã—Ç—å –ª–∏—à–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

### –ú–µ—Ç–æ–¥ 1: Blob URL (—Ç–µ–∫—É—â–∏–π)
```typescript
const blob = new Blob([data], { type: 'text/csv' })
const url = URL.createObjectURL(blob)
link.href = url
link.click()
URL.revokeObjectURL(url)
```
**‚úÖ –ü–ª—é—Å—ã:** –†–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞
**‚ùå –ú–∏–Ω—É—Å—ã:** –ú–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏

### –ú–µ—Ç–æ–¥ 2: Data URI (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π)
```typescript
const dataUri = 'data:text/csv;charset=utf-8,' + encodeURIComponent(data)
link.href = dataUri
link.click()
```
**‚úÖ –ü–ª—é—Å—ã:** –ü—Ä–æ—Å—Ç–æ–π, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ
**‚ùå –ú–∏–Ω—É—Å—ã:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ ~2MB, –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π

### –ú–µ—Ç–æ–¥ 3: FileSaver.js (–µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
```bash
npm install file-saver
```
```typescript
import { saveAs } from 'file-saver'
const blob = new Blob([data], { type: 'text/csv' })
saveAs(blob, 'personnel_template.csv')
```
**‚úÖ –ü–ª—é—Å—ã:** –ö—Ä–æ—Å—Å-–±—Ä–∞—É–∑–µ—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
**‚ùå –ú–∏–Ω—É—Å—ã:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

## üîç –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É Blob
console.log('Blob API:', typeof Blob !== 'undefined')

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å createObjectURL
console.log('createObjectURL:', typeof URL.createObjectURL === 'function')

// –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è Blob
const testBlob = new Blob(['test'], { type: 'text/plain' })
console.log('Test Blob size:', testBlob.size)

// –¢–µ—Å—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
const testUrl = URL.createObjectURL(testBlob)
const testLink = document.createElement('a')
testLink.href = testUrl
testLink.download = 'test.txt'
document.body.appendChild(testLink)
testLink.click()
document.body.removeChild(testLink)
URL.revokeObjectURL(testUrl)
console.log('‚úÖ Test download executed')
```

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

### Windows Chrome
```
‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ü–∞–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∫–∏"
```

### Windows Firefox
```
‚ö†Ô∏è –ú–æ–∂–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ó–∞–≥—Ä—É–∑–∫–∏ ‚Üí –í—Å–µ–≥–¥–∞ —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å
```

### Windows Edge
```
‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: edge://settings/downloads
```

### Mac Safari
```
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: ~/Downloads
```

### Mac Chrome
```
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```

### Linux
```
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: ~/Downloads
```

## üí° –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å

### –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:
1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å `test-download.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. ‚úÖ –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
3. ‚úÖ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ –æ–∫–Ω–µ
4. ‚úÖ –°–∫—Ä–∏–Ω—à–æ—Ç –ª–æ–≥–æ–≤ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É
5. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Console
6. ‚úÖ –°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É
7. ‚úÖ DevTools ‚Üí Network ‚Üí —Å–∫—Ä–∏–Ω—à–æ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤

### –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é:
```csv
–ò–º—è;–î–æ–ª–∂–Ω–æ—Å—Ç—å;–†–æ–ª—å;Email;–¢–µ–ª–µ—Ñ–æ–Ω
–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω;–î–∏—Ä–µ–∫—Ç–æ—Ä;issuer;ivanov@example.com;+79991234567
–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä;–ú–∞—Å—Ç–µ—Ä;foreman;petrov@example.com;+79991234568
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ `template.csv` –≤ –ë–ª–æ–∫–Ω–æ—Ç–µ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8.

## üéØ –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω"**
2. ‚úÖ Toast: "–®–∞–±–ª–æ–Ω —Å–∫–∞—á–∞–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É –ó–∞–≥—Ä—É–∑–∫–∏"
3. ‚úÖ Console: "‚úÖ Template downloaded: { fileName, size, delimiter, locale }"
4. ‚úÖ –§–∞–π–ª `personnel_template.csv` –ø–æ—è–≤–∏–ª—Å—è –≤ –ø–∞–ø–∫–µ –ó–∞–≥—Ä—É–∑–∫–∏
5. ‚úÖ –§–∞–π–ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Excel —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
6. ‚úÖ –†—É—Å—Å–∫–∏–µ/—Ç—É—Ä–µ—Ü–∫–∏–µ –±—É–∫–≤—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

**–í–µ—Ä—Å–∏—è:** 1.1  
**–î–∞—Ç–∞:** 28 –Ω–æ—è–±—Ä—è 2024  
**–°—Ç–∞—Ç—É—Å:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ ‚úÖ
